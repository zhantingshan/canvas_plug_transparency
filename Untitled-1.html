<!DOCTYPE html>
<html> <head>
 <meta charset="gbk">
 <title>实现的遮罩动画</title>
<style>
*{ margin:0; padding:0; width:100%;}
.head{ height:300px; background-image:url(head.jpg); background-position:center; background-repeat: no-repeat; background-size: cover; position:absolute}

</style>
</head>
<body>
<div class="head"></div>

<script> 

var imageCanvas;  
   var maskCanvas;  
   var imageContext;  
   var maskContext;  
   var frameCount=0;  
   var nextFrames=0;  
   var maskX=225;  
   var maskY=160;  
   var maskSpeedX=0;  
   var maskSpeedY=0;  
   var MASK_R=75;  
   var CANVAS_WIDTH=document.getElementsByClassName('head')[0].clientWidth;  
   var CANVAS_HEIGHT=300;  
 
            function pageInit(){  
			    //创建图片canvas标签
                imageCanvas=document.createElement("canvas");  
                imageCanvas.width=CANVAS_WIDTH;  
                imageCanvas.height=CANVAS_HEIGHT;  
                document.body.appendChild(imageCanvas);  
                imageCanvas.style.position="absolute"; 
				//getContext() 方法返回一个用于在画布上绘图的环境。 
                imageContext=imageCanvas.getContext("2d");
				//创建一个Image对象  
                var img=new Image();  
                img.onload=function(){  
				    //绘制图片
                    imageContext.drawImage(img,0,0);  
                }
				//src 属性一定要写到 onload 的后面，否则程序在 IE 中会出错。 在 IE 中，img 对象的加载是不包含在 body 的加载过程之中的，body 加载完毕，window.onload 事件触发时，
                //img对象可能还未加载结束，img.onload事件会在 window.onload 之后触发  
                img.src="head.jpg";  
                maskCanvas=document.createElement("canvas");  
                maskCanvas.width=CANVAS_WIDTH;  
                maskCanvas.height=CANVAS_HEIGHT;  
                document.body.appendChild(maskCanvas);  
                maskCanvas.style.position="absolute";  
                maskContext=maskCanvas.getContext("2d");  
   
                resetSpeed();  
                setInterval(moveMask,20);  
            }  
   
            function resetSpeed(){  
                maskSpeedX=Math.random()*10-5;  
                maskSpeedY=Math.random()*10-5;  
   
                resetNextFrames();  
            }  
   
            function resetNextFrames(){  
                nextFrames=Math.random()*125+25;  
            }  
   
            function moveMask(){  
                //在给定矩形内清空一个矩形：
                maskContext.clearRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);  
				//下面覆盖上面
                maskContext.globalCompositeOperation="source-over";  
                maskContext.fillRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);  
				//上面覆盖下面
                maskContext.globalCompositeOperation="destination-out"; 
				//设置填充色
				maskContext.fillStyle='rgba(205,198,115,0.8)';
				//执行填充 
                maskContext.fill(); 
				//重置当前的路径
                maskContext.beginPath(); 
				//1和2代表圆心坐标.3是圆的半径.4代表圆周起始位置.0 PI就是起始位置.沿顺时针路线,分别是0.5 PI（正下方）,1 PI和1.5 PI（正上方）,为画饼图提供了扇形范围的依据.第五个参数是弧长Math.PI*2就是整个圆,Math.PI是半圆.第六个参数是一个布尔值,true是顺时针false是顺时针. 
                maskContext.arc(maskX,maskY,MASK_R,0,Math.PI*2,true); 
				//设置字体粗细大小
			    maskContext.font = 'bold 144px arial';
                maskContext.textAlign = 'left';
                maskContext.textBaseline = 'top';
				//写文字w3school.com.cn ，坐标10,90
                maskContext.fillText("w3school.com.cn",10,90);
				
                maskX+=maskSpeedX;  
                maskY+=maskSpeedY;  
   
                if(maskX>=CANVAS_WIDTH-MASK_R){  
				    //Math.abs取决对值
                    maskSpeedX=-Math.abs(maskSpeedX);  
                }  
                if(maskX<=MASK_R){  
                    maskSpeedX=Math.abs(maskSpeedX);  
                }  
                if(maskY>=CANVAS_HEIGHT-MASK_R){  
                    maskSpeedY=-Math.abs(maskSpeedY);  
                }  
                if(maskY<=MASK_R){  
                    maskSpeedY=Math.abs(maskSpeedY);  
                }  
   
                frameCount++;  
				//重置速度
                if(frameCount>nextFrames){  
                    frameCount=0;  
                    resetSpeed();  
                }  
            }  
          pageInit();
</script>
</body> 
</html>